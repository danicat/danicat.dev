+++
date = '2025-07-02T00:00:00+01:00'
title = 'Do Prompt √† Infraestrutura com o Gemini Cloud Assist'
summary = "Como projetar infraestrutura usando linguagem natural usando o Gemini Cloud Assist no Google Cloud"
tags = ["gemini", "cloud assist", "terraform"]
+++
{{< translation-notice >}}
## Introdu√ß√£o

Hoje vamos fazer um pequeno desvio do nosso conte√∫do usual sobre agentes de IA para falar sobre um produto que explorei recentemente como parte da minha participa√ß√£o no I/O Connect Berlin 2025 na semana passada.

Este evento reuniu mais de 1000 desenvolvedores de toda a Europa, incluindo membros das comunidades de desenvolvedores do Google (Google Developer Groups) e especialistas da comunidade. Foi tamb√©m o meu primeiro evento oficial do Google desde que entrei para a equipe de DevRel em abril, por isso foi particularmente significativo para mim - e √© por isso que n√£o tivemos atualiza√ß√£o no blog na semana passada!

Fui respons√°vel por uma demonstra√ß√£o chamada ‚ÄúDesign and Deploy‚Äù, que mostra a combina√ß√£o de dois produtos: [Application Design Center (ADC)](https://cloud.google.com/application-design-center/docs/overview?utm_campaign=CDR_0x72884f69_awareness_b428663487&utm_medium=external&utm_source=blog) e [Gemini Cloud Assist (GCA)](https://cloud.google.com/products/gemini/cloud-assist?utm_campaign=CDR_0x72884f69_awareness_b428663487&utm_medium=external&utm_source=blog). A demonstra√ß√£o foi t√£o bem recebida que achei que seria bom trazer esse conte√∫do para o blog tamb√©m, para dar a oportunidade √†s pessoas que n√£o estavam l√° de brincar com essa tecnologia tamb√©m.

O Application Design Center √© um produto para ajudar arquitetos e desenvolvedores a projetar a infraestrutura de seus aplicativos. Na frente, ele fornece uma interface de usu√°rio agrad√°vel onde voc√™ pode definir visualmente os componentes para sua infraestrutura, mas por baixo dos panos tudo na interface do usu√°rio √© representado como um m√≥dulo terraform para que voc√™ tamb√©m possa aproveitar os benef√≠cios da [Infraestrutura como C√≥digo](https://en.wikipedia.org/wiki/Infrastructure_as_code).

Um aviso importante √© que o ADC est√° atualmente em [pr√©-visualiza√ß√£o p√∫blica](https://cloud.google.com/products?e=48754805&hl=en#product-launch-stages&utm_campaign=CDR_0x72884f69_awareness_b428663487&utm_medium=external&utm_source=blog). Isso significa que o produto est√° evoluindo a cada dia e, √†s vezes, pode quebrar a compatibilidade com itera√ß√µes anteriores. Ele tamb√©m tem algumas arestas notavelmente √°speras que mencionarei abaixo, que devem ser resolvidas antes que o produto se torne dispon√≠vel para o p√∫blico em geral.

O Gemini Cloud Assist (tamb√©m em pr√©-visualiza√ß√£o p√∫blica), por outro lado, √© o nome oficial do produto para o suporte do Gemini no Google Cloud. Por causa disso, o GCA n√£o √© um produto aut√¥nomo, mas mais como um tecido conjuntivo que permite aos usu√°rios interagir com qualquer coisa do GCP usando linguagem natural, incluindo todos os benef√≠cios da moderna experi√™ncia de chatbot baseada em modelos de linguagem grandes.

Vamos ver como podemos usar ambas as tecnologias para projetar rapidamente a parte de infraestrutura de um aplicativo para n√≥s.


## Como iniciar uma sess√£o de design de aplicativo

Voc√™ sempre pode abrir o Application Design Center manualmente no console do Google Cloud, mas qual √© a gra√ßa disso? A melhor maneira de acionar o ADC para um novo design √© simplesmente abrir o painel do Gemini em qualquer p√°gina. Aqui, por exemplo, estou usando a p√°gina de boas-vindas do meu projeto:

![alt_text](images/image001.png "Tela de boas-vindas no console do Google Cloud")


Se voc√™ clicar no bot√£o ‚Äúestrela‚Äù no lado direito da barra de pesquisa, abrir√° o painel do Gemini Cloud Assist:

![alt_text](images/image002.png "Vis√£o ampliada do bot√£o Gemini")

Deve abrir:

![alt_text](images/image003.png "Tela de boas-vindas do Google Cloud Assist")


Este √© o painel onde voc√™ pode interagir com o Gemini. Digite algo como ‚Äúcriar um aplicativo que faz x‚Äù e inclua quantos detalhes desejar sobre a arquitetura. Por exemplo, vamos tentar criar um aplicativo que gera fotos de gatos. Aqui est√° o prompt:

> Crie um aplicativo que gere fotos de gatos com o Gemini e as armazene em um banco de dados Cloud SQL. Os usu√°rios podem solicitar novas fotos usando um servi√ßo de gera√ß√£o e podem ver as fotos geradas com um servi√ßo de fotos. Ambos os servi√ßos s√£o expostos por meio de um servi√ßo de frontend e um balanceador de carga global.

Depois de inserir o prompt, o Gemini pensar√° por um tempo e, ap√≥s alguns segundos, produzir√° uma sa√≠da como esta:

![alt_text](images/image004.png "Resposta do Gemini com diagrama de arquitetura")

A visualiza√ß√£o integrada nos d√° uma ideia, mas podemos interagir melhor com o design se clicarmos no bot√£o ‚ÄúEdit app design‚Äù. Isso abrir√° o design em uma visualiza√ß√£o expandida para que possamos refin√°-lo ainda mais. (Observe que o restante deste artigo pressup√µe que o bot√£o ‚ÄúEdit app design‚Äù abre a janela de Pr√©-visualiza√ß√£o. Se no seu caso n√£o abrir, verifique as notas no final do artigo)

√â assim que fica na janela de ‚ÄúPr√©-visualiza√ß√£o‚Äù:

![alt_text](images/image005.png "Janela de Pr√©-visualiza√ß√£o do Gemini Cloud Assist")

Se voc√™ n√£o estiver satisfeito com as conven√ß√µes de nomenclatura ou com os detalhes dos componentes gerados, poder√° sempre alter√°-los clicando no componente e abrindo o painel de configura√ß√£o. Aqui abri o painel de configura√ß√£o do meu `frontend-service`:

![alt_text](images/image006.png "Vis√£o do painel de detalhes do componente")

Observe que esta tela tamb√©m mostra qual cont√™iner √© instanciado pelo Cloud Run, que assume como padr√£o um cont√™iner ‚Äúhello‚Äù. Isso ocorre porque o Gemini Cloud Assist n√£o tem informa√ß√µes sobre qual cont√™iner voc√™ deseja executar, mas se voc√™ fornecer essas informa√ß√µes, ele poder√° substituir o valor.

Estou destacando isso aqui tamb√©m por outro motivo - precisamos definir as expectativas de que esta ferramenta n√£o codifica o aplicativo para voc√™, ela apenas projeta a infraestrutura para suport√°-lo. Para codificar os servi√ßos de frontend e backend reais, por exemplo, voc√™ precisar√° usar outras ferramentas como o Gemini CLI ou seu IDE regular e publicar os artefatos em seu registro de cont√™iner para que o Cloud Run possa acess√°-los.

Na janela de Pr√©-visualiza√ß√£o, voc√™ pode editar componentes, mas n√£o adicionar componentes manualmente. Se voc√™ quiser iterar no design, o que voc√™ pode fazer √© pedir ao Gemini para modificar o design para voc√™. Veja, por exemplo, este prompt de acompanhamento:

> Adicione um servi√ßo de streaming que capture eventos para cada foto de gato gerada. Do outro lado do stream, h√° um servi√ßo de consumidor que atualizar√° uma p√°gina est√°tica hospedada no GCS, adicionando as fotos mais recentes a um feed.

Esta √© a resposta do Gemini:

![alt_text](images/image007.png "Resposta do Gemini ao prompt de acompanhamento")

E a janela de Pr√©-visualiza√ß√£o ser√° atualizada com o novo design, destacando adi√ß√µes (verde), modifica√ß√µes (azul) e exclus√µes (vermelho):

![alt_text](images/image008.png "Altera√ß√µes propostas no diagrama")

Na parte inferior da tela, voc√™ tem a op√ß√£o de aceitar ou rejeitar a sugest√£o. Mas antes disso, √© uma boa oportunidade para inspecionar o c√≥digo terraform que √© gerado por baixo dos panos. Para ver o c√≥digo e comparar as altera√ß√µes, clique em ‚ÄúView diff‚Äù:

Isso abrir√° a janela Code Diff com ambas as vers√µes mostradas lado a lado:

![alt_text](images/image009.png "Janela de revis√£o de diferen√ßas mostrando compara√ß√£o entre o c√≥digo terraform antes e depois")

Como voc√™ pode ver, cada caixa no diagrama √© mapeada para um m√≥dulo terraform diferente. Se voc√™ rolar para baixo, poder√° ver os m√≥dulos que ele adicionou recentemente destacados em verde.

Se voc√™ estiver satisfeito com a implementa√ß√£o, pode aceitar a sugest√£o ou rejeitar e pedir ao Gemini para melhor√°-la. Aceitei a sugest√£o, mas notei algo um pouco estranho sobre o m√≥dulo ‚Äúdatabase-secrets‚Äù, ent√£o decidi perguntar ao Gemini sobre isso:

Prompt: ‚Äúpor que voc√™ adicionou um segredo de banco de dados se o banco de dados Cloud SQL est√° usando autentica√ß√£o IAM?‚Äù

Bem, acho que n√£o era realmente necess√°rio:

![alt_text](images/image010.png "Resposta do Gemini √† pergunta sobre IAM")

Na janela de Pr√©-visualiza√ß√£o:

![alt_text](images/image011.png "Proposta do Gemini para remover o segredo do banco de dados")

Este √© um alerta importante de que, por mais que a IA tenha se tornado cada vez mais avan√ßada, ainda n√£o estamos isentos de avaliar e tomar decis√µes. No final das contas, a IA ainda estar√° l√°, mas nossos empregos est√£o em jogo, ent√£o n√£o se esque√ßa de validar tudo. üôÇ

Sobre o tema de valida√ß√µes, outra coisa que me chamou a aten√ß√£o √© que o Gemini estava sugerindo um tipo de inst√¢ncia Cloud SQL razoavelmente grande: `db-perf-optimized-N-8`. Vamos tentar outro prompt para melhorar isso, pois isso definitivamente √© demais para um prot√≥tipo pequeno:

> Torne-o econ√¥mico

![alt_text](images/image012.png "Resposta do Gemini sugerindo um balanceador de carga regional e substituindo o Postgres por MySQL")

Hmmm‚Ä¶ essa me fez pensar. Entendo o ponto sobre o balanceador de carga regional versus global, mas n√£o estou convencido do motivo pelo qual ele acha que o MySQL √© mais econ√¥mico do que o PostgreSQL. Eu estava mais preocupado com o tipo de m√°quina do que com a tecnologia de banco de dados real.

A resposta do Gemini n√£o nos conta toda a hist√≥ria, no entanto. Inspecionando o `diff` de perto, ele nos mostra que na verdade modificou o tipo de m√°quina (mostrado como o atributo `tier`) e simplesmente esqueceu de nos dizer:

![alt_text](images/image013.png "Diff do Terraform mostrando que o Gemini tamb√©m alterou o tipo de m√°quina (tier)")

N√£o estou totalmente satisfeito com isso, ent√£o vou perguntar por qu√™:

![alt_text](images/image014.png "Perguntando ao Gemini por que ele acha que o MySQL √© mais econ√¥mico do que o Postgres")

A resposta sugere que o MySQL √© mais econ√¥mico que o Postgres devido a:
1. Diferen√ßas de licenciamento
2. Consumo de recursos
3. Pre√ßos de servi√ßos gerenciados

Infelizmente, n√£o posso concordar com esta resposta. Para o item 1, ambos t√™m licen√ßas de c√≥digo aberto, portanto, n√£o s√£o t√£o diferentes. Talvez o item 2 possa ter alguma verdade, mas eu ainda precisaria de um benchmark adequado. O item 3 est√° errado porque o Cloud SQL para Postgres e MySQL t√™m o mesmo modelo de pre√ßos no GCP. Mais um ponto para os humanos, vamos reverter a mudan√ßa:

> reverta a altera√ß√£o de postgres para mysql, mas mantenha o tipo de m√°quina menor.

Inspe√ß√£o final: estou feliz com o Cloud SQL executando Postgres em um n√≠vel de banco de dados menor, mas tamb√©m descobri que h√° outra edi√ß√£o not√°vel que ativa o recurso de escalonamento para zero do Cloud Run:

![alt_text](images/image015.png "Diff do Terraform mostrando que o Cloud Run foi configurado com escalonamento para zero (min_instance_count = 0)")

Este faz muito sentido, mas tamb√©m n√£o foi mencionado no di√°logo. Este √© outro lembrete para ‚Äúconfiar, mas verificar‚Äù o que quer que sua ferramenta de IA esteja lhe dizendo. N√£o queremos surpresas rodando em produ√ß√£o.

## Recuperando os Arquivos Terraform

Depois de estar satisfeito com o design, voc√™ pode clicar no bot√£o ‚Äú&lt;&gt; Get Code‚Äù no canto superior direito da interface do usu√°rio. Isso compactar√° o c√≥digo terraform subjacente em um arquivo zip para voc√™ baixar para sua m√°quina local.

Infelizmente, no momento em que este artigo foi escrito, o Application Design Center n√£o oferece suporte a nenhuma integra√ß√£o com sistemas de controle de vers√£o de c√≥digo como GitHub, GitLab, Google Source, Bitbucket e outros. A √∫nica maneira de extrair o c√≥digo da ferramenta √© por meio do download deste arquivo zip.

Para pessoas que usam contas corporativas com uma hierarquia organizacional completa, voc√™ pode pegar este design e implant√°-lo usando o AppHub, mas se voc√™ estiver usando sua conta pessoal, infelizmente este √© o limite do que a ferramenta pode fazer por voc√™.


## Notas sobre a interface do usu√°rio do App Design Center

O bot√£o ‚ÄúEdit app design‚Äù ter√° comportamentos diferentes dependendo de como seu console da nuvem est√° configurado. Se voc√™ estiver testando este prompt de sua conta pessoal e sua conta pessoal n√£o estiver vinculada a uma organiza√ß√£o, ele abrir√° uma janela de Pr√©-visualiza√ß√£o onde voc√™ poder√° ver o design e baixar o c√≥digo terraform correspondente, mas n√£o ter√° acesso √† interface de usu√°rio completa do App Design Center.

Para usar a interface completa, voc√™ precisa fazer parte de uma organiza√ß√£o, pois a configura√ß√£o do App Design Center precisa de um tipo especial de pasta configurada, denominada pasta ‚Äúhabilitada para o app design center‚Äù. N√£o h√° como adicionar pastas a contas sem uma organiza√ß√£o e, dentro de uma organiza√ß√£o, esta pasta precisa ser configurada pelo administrador da nuvem.

Infelizmente, isso significa que as contas de usu√°rio que n√£o pertencem a nenhuma organiza√ß√£o ficar√£o efetivamente bloqueadas do conjunto completo de recursos do ADC, pelo menos por enquanto.

Voc√™ ainda poder√° usar o Gemini para ajud√°-lo a prototipar a arquitetura do seu aplicativo, assim como mostrei neste artigo, mas n√£o poder√° salvar seu progresso na interface do usu√°rio da nuvem e precisar√° baixar os arquivos terraform para sua m√°quina local e implant√°-los usando sua pr√≥pria instala√ß√£o do terraform.

## Conclus√µes e pr√≥ximos passos

Cada novo produto de IA lan√ßado me deixa animado com a ideia de ter aquele momento ‚ÄúTony Stark‚Äù em que voc√™ pode projetar seu software apenas usando comandos de voz. Ainda n√£o chegamos l√°, mas com o Gemini Cloud Assist estamos progredindo bem, pois agora podemos usar linguagem natural para especificar os componentes de infraestrutura para n√≥s.

Ainda existem algumas arestas √°speras tanto em termos de interface do usu√°rio quanto nas sugest√µes do Gemini, mas j√° estou aliviado por n√£o ter que criar manualmente o c√≥digo terraform para cada novo aplicativo que estou desenvolvendo.

Este √© claramente um artigo que deve ter uma data de validade, pois devemos ver essa ferramenta evoluir muito rapidamente nos pr√≥ximos meses. Para se manter atualizado, voc√™ sempre pode verificar a p√°gina do produto [Application Design Center](https://cloud.google.com/application-design-center/docs/overview?utm_campaign=CDR_0x72884f69_awareness_b428663487&utm_medium=external&utm_source=blog), mas √© claro que farei o meu melhor para escrever sobre novos recursos e melhorias interessantes neste blog tamb√©m.

Como algumas sugest√µes, recomendo que voc√™ experimente alguns prompts criativos como ‚Äútorne-o econ√¥mico‚Äù, ‚Äútorne-o altamente dispon√≠vel‚Äù, ‚Äúexplique por que x em vez de y‚Äù, ‚Äúsubstitua x por y‚Äù, ‚Äúexplique x para mim como se eu tivesse 5 anos‚Äù, e assim por diante.

Quais s√£o seus pensamentos? Voc√™ achou esta ferramenta empolgante ou assustadora? Voc√™ encontrou algum prompt interessante? Deixe seus coment√°rios abaixo!
